# Prevent PHP execution in data directory
# Serve all script files as plain text instead

# Disable PHP processing
php_flag engine off

# Force all script files to be served as plain text
<FilesMatch "\.(php|php3|php4|php5|php7|phtml|pl|py|jsp|asp|sh|cgi)$">
    # Remove script handlers
    SetHandler none
    SetHandler default-handler
    Options -ExecCGI
    
    # Force content type to plain text
    ForceType text/plain
    
    <IfModule mod_php5.c>
        php_flag engine off
    </IfModule>
    <IfModule mod_php7.c>
        php_flag engine off
    </IfModule>
    <IfModule mod_php.c>
        php_flag engine off
    </IfModule>
</FilesMatch>

# Additional security headers
<IfModule mod_headers.c>
    Header set X-Content-Type-Options "nosniff"
    Header set X-Frame-Options "SAMEORIGIN"
    Header set Content-Security-Policy "default-src 'none'"
</IfModule>
